function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{C as P,a as S,o as M}from"./const-D6IH2YzA.js";import{c as V,a as B,l as U}from"./utils-D0PhfvxW.js";import{d as O,r as p,o as G,c as d,a as r,F as b,b as L,_ as T,e as i,t as v,q,j as z,s as J,x as N}from"./index-C3vdtt9O.js";const H={class:"width-full p-4 overflow-auto"},K={class:"border-collapse border border-slate-500",style:{"background-color":"#141414",color:"rgba(255, 255, 255, 0.87)"}},Q=O({__name:"index",props:{incomeDataList:{}},setup(C){const{incomeDataList:h}=C,_=p([]),g=p([]);function D(){const m=h.map(u=>Object.keys(u).length),y=Math.max(...m),f=m.findIndex(u=>u===y);_.value=Object.keys(h[f]),g.value=h.map(u=>_.value.reduce((l,x)=>(l[x]=u[x]||"-",l),{}))}function w(){const m=document.querySelector("table");T(()=>import(P),__vite__mapDeps([])).then(({default:y})=>{y(m).then(f=>{const u=f.toDataURL("image/png"),l=document.createElement("a");l.href=u,l.download=`${h[0].time}-${h[h.length-1].time}.png`,l.click()})})}function c(){let m=`| ${_.value.join(" | ")} |
`;m+=`| ${_.value.map(()=>"---").join(" | ")} |
`,g.value.forEach(y=>{const f=Object.values(y);m+=`| ${f.join(" | ")} |
`}),V(m)}return G(()=>{D()}),(m,y)=>(i(),d(b,null,[r("div",{class:"flex flex-justify-end"},[r("button",{onClick:w}," 下载图片 "),r("button",{onClick:c}," 复制md ")]),r("div",H,[r("table",K,[r("thead",null,[r("tr",null,[(i(!0),d(b,null,L(_.value,(f,u)=>(i(),d("th",{key:u,class:"border-solid border-slate-700"},v(f),1))),128))])]),r("tbody",null,[(i(!0),d(b,null,L(g.value,(f,u)=>(i(),d("tr",{key:u},[(i(!0),d(b,null,L(f,(l,x)=>(i(),d("td",{key:x,class:"border-solid border-slate-700 px-2 text-center"},v(l.toLocaleString()),1))),128))]))),128))])])])],64))}}),W=r("h3",{class:"px-2"}," 总到手情况 ",-1),X=r("p",{class:"px-2 font-size-3"}," 收入包含提取公积金、饭补。支出包含五险一金、房租支出 ",-1),Y=r("h3",{class:"px-2"}," 硬性支出情况 ",-1),Z=r("h3",{class:"px-2"}," 收入情况 ",-1),ee=r("p",{class:"px-2 font-size-3"}," 包含提取公积金、饭补 ",-1),oe=O({__name:"index",setup(C){function h(n){let t=0;for(const o in n)n.hasOwnProperty(o)&&typeof n[o]=="number"&&(t+=n[o]);return t}function _(n){return n.reduce((t,o)=>t+o,0)}const g=p(),D=p(),w=p(),c=p({});function m(n){const t=n.map(e=>({time:e.time,value:h(e),type:"实际收入"})),o=n.map(e=>{const R=Object.entries(e).filter(([j,$])=>$<0).reduce((j,[,$])=>j+$,0);return{time:e.time,value:-R,type:"硬性支出"}}),a=[...o,...t];c.value.至今到手总收入=_(t.map(e=>e.value)),c.value.至今税金房租总支出=_(o.map(e=>e.value)),c.value.至今税前总收入=c.value.至今税金房租总支出+c.value.至今到手总收入,c.value.至今平均到手月入=c.value.至今到手总收入/n.length,c.value.预计税前年入=c.value.至今税前总收入/n.length*12,c.value.预计到手年入=c.value.至今平均到手月入*12,new G2Plot.Area(g.value,{data:a,xField:"time",yField:"value",seriesField:"type",theme:"dark",label:{callback:e=>{if(+e>1e4)return{content:e}}},tooltip:{customItems:e=>{const k=e.reduce((R,j)=>R+ +j.value,0);return[...e,{name:"税前收入",value:k}]}}}).render()}function y(n){const t=[];if(n.forEach(a=>{Object.entries(a).sort((s,e)=>e[1]-s[1]).forEach(([s,e])=>{typeof e=="number"&&e<0&&t.push({time:a.time,value:-e,type:s})})}),t.length>1){const a=t[0];t[0]=t[1],t[1]=a}new G2Plot.Area(D.value,{data:t,xField:"time",yField:"value",theme:"dark",seriesField:"type",tooltip:{customItems:a=>{const s=a.reduce((e,k)=>e+ +k.value,0);return[...a,{name:"总支出",value:s}]}}}).render()}function f(n){const t=[];if(n.forEach(a=>{Object.entries(a).sort((s,e)=>s[1]-e[1]).forEach(([s,e])=>{typeof e=="number"&&e>=0&&t.push({time:a.time,value:e,type:s})})}),t.length>1){const a=t[0];t[0]=t[1],t[1]=a}new G2Plot.Area(w.value,{data:t,xField:"time",yField:"value",seriesField:"type",theme:"dark",yAxis:{min:2e4},tooltip:{customItems:a=>{const s=a.reduce((e,k)=>e+ +k.value,0);return[...a,{name:"税前收入",value:s}]}}}).render()}const u=p(""),l=p([]),x=p([{time:"2024-1",年终奖:"100",换算为月均:4364.5},{time:"2024-3",退税:875.16}]);async function A(){const n="incomeData",t="incomeDataList",o=`${M}/${n}.js`,{data:a,msg:s}=await B(t,o);return u.value=s,l.value=a,a}async function E(){window.G2Plot||await U(S)}async function F(){const[n]=await Promise.all([A(),E()]);m(n),y(n),f(n)}function I(){localStorage.removeItem("incomeDataList"),F()}return q(()=>{F()}),(n,t)=>(i(),d(b,null,[z(v(u.value)+" ",1),r("div",{class:"btn btn-primary",onClick:I}," 刷新 "),l.value.length?(i(),d(b,{key:0},[r("p",null,v(l.value[0].time)+"~"+v(l.value[l.value.length-1].time)+" ("+v(l.value.length)+") ",1),r("ul",null,[(i(!0),d(b,null,L(c.value,(o,a)=>(i(),d("li",{key:a},v(a)+": "+v(o==null?void 0:o.toLocaleString()),1))),128))]),W,X,r("div",{ref_key:"totalRef",ref:g},null,512),Y,r("div",{ref_key:"lostRef",ref:D},null,512),Z,ee,r("div",{ref_key:"inRef",ref:w},null,512),r("ul",null,[(i(!0),d(b,null,L(x.value,(o,a)=>(i(),d("li",{key:a},v(Object.keys(o).map(s=>s==="time"?o[s]:`${s}
        ${o[s]}`).join(" ")),1))),128))]),l.value.length?(i(),J(Q,{key:0,"income-data-list":l.value},null,8,["income-data-list"])):N("",!0)],64)):N("",!0)],64))}});export{oe as default};
